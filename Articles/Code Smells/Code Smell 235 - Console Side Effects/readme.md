# Code Smell 235 - Console Side Effects
            
![Code Smell 235 - Console Side Effects](Code%20Smell%20235%20-%20Console%20Side%20Effects.png)

*You compute and log in the same place*

> TL;DR: Avoid side effects

# Problems

- Coupling

- Testability

- Reusability

- Function Composition

# Solutions

1. Decouple the code and avoid side-effects

2. Inject the output destination

# Context

Outputting to the console within an internal function generates coupling and side effects

# Sample Code

## Wrong

<!-- [Gist Url](https://gist.github.com/mcsee/c8fcd38572bce8e59bf28ceaede7a055) -->

```javascript
function drawChristmasTree(height) {
  let tree = '';
  let currentFloor = 1;

  while (currentFloor <= height) { 
      tree += ' '.repeat(height - currentFloor) + 
        'ðŸŽ„'.repeat(currentFloor)
        + '\n';
      currentFloor++;
  }

  // This function has side effects
  // You cannot test it
  console.log(tree);
}

drawChristmasTree(7);
```

## Right

<!-- [Gist Url](https://gist.github.com/mcsee/1c4881a54286a827b8fc037fdd89722c) -->

```javascript
function createChristmasTree(height) {
  let tree = '';
  let currentFloor = 1;

  while (currentFloor <= height) { 
      tree += ' '.repeat(height - currentFloor) +
        'ðŸŽ„'.repeat(currentFloor)
        + '\n';
      currentFloor++;
  }

  return tree;
}

// The side effects are OUTSIDE the function
console.log(createChristmasTree(7));

// You can also test it 

const createChristmasTree = createChristmasTree(7);

describe('createChristmasTree', () => {
  it('should create a Christmas tree of the specified height',
     () => {
    const expectedTree = 
      '      ðŸŽ„\n' +
      '     ðŸŽ„ðŸŽ„\n' +
      '    ðŸŽ„ðŸŽ„ðŸŽ„\n' +
      '   ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„\n' +
      '  ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„\n' +
      ' ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„\n' +
      'ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„ðŸŽ„\n';

    const result = createChristmasTree(7);
    expect(result).toEqual(expectedTree);
  });

});
```

# Detection

[X] Automatic 

Several linters warn for this usage

# Tags

- Globals

# Conclusion

Instead of logging directly within internal functions, a more modular and flexible approach is to have functions return values or throw exceptions when errors occur. 

The calling code can then decide how to handle and log these results based on the application's logging strategy.

# Relations

[Code Smell 17 - Global Functions](https://github.com/mcsee/Software-Design-Articles/tree/main/Articles/Code%20Smells/Code%20Smell%2017%20-%20Global%20Functions/readme.md)

# Disclaimer

Code Smells are my [opinion](https://github.com/mcsee/Software-Design-Articles/tree/main/Articles/Blogging/I%20Wrote%20More%20than%2090%20Articles%20on%202021%20Here%20is%20What%20I%20Learned/readme.md).

# Credits

Image generated by Midjourney
  
* * *

> Memory is like an orgasm. It's a lot better if you don't have to fake it.

_Seymour Cray_
 
[Software Engineering Great Quotes](https://github.com/mcsee/Software-Design-Articles/tree/main/Articles/Quotes/Software%20Engineering%20Great%20Quotes/readme.md)

* * *

This article is part of the CodeSmell Series.

[How to Find the Stinky Parts of your Code](https://github.com/mcsee/Software-Design-Articles/tree/main/Articles/Code%20Smells/How%20to%20Find%20the%20Stinky%20parts%20of%20your%20Code/readme.md)