Mejorá este código y hacelo más limpio